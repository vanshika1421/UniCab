<!DOCTYPE html>
<html>
<head>
  <title>UniCab - Driver Dashboard</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:linear-gradient(135deg,#e8f5e8 0%,#e3f2fd 100%); min-height:100vh; position:relative; background-attachment: fixed;}
    body::before { content:''; position:fixed; top:0; left:0; width:100%; height:100%; background-image:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="cars" patternUnits="userSpaceOnUse" width="100" height="100"><rect width="100" height="100" fill="none"/><path d="M20 60h60c2 0 4-2 4-4v-20c0-2-2-4-4-4H20c-2 0-4 2-4 4v20c0 2 2 4 4 4z" fill="rgba(255,255,255,0.05)"/><circle cx="30" cy="70" r="8" fill="rgba(255,255,255,0.03)"/><circle cx="70" cy="70" r="8" fill="rgba(255,255,255,0.03)"/></pattern></defs><rect width="100" height="100" fill="url(%23cars)"/></svg>'); opacity:0.1; z-index:-1;}

    .container { max-width:1000px; margin:20px auto; background:rgba(255,255,255,0.95); backdrop-filter:blur(10px); border-radius:20px; box-shadow:0 20px 40px rgba(0,0,0,0.1); padding:0; overflow:hidden; border:1px solid rgba(255,255,255,0.2);}
    .header { background:linear-gradient(135deg,#ffcc02 0%,#81c784 50%,#64b5f6 100%); padding:30px 40px; text-align:center; position:relative; overflow:hidden;}
    .header::before { content:'ğŸ‘¨â€âœˆï¸'; position:absolute; font-size:60px; opacity:0.2; left:20px; top:10px; animation:float 3s ease-in-out infinite; }
    .header::after { content:'ğŸ“‹'; position:absolute; font-size:40px; opacity:0.3; right:30px; bottom:20px; animation:float 2s ease-in-out infinite reverse;}
    @keyframes float { 0%,100% {transform:translateY(0);} 50% {transform:translateY(-10px);} }
    h1 { color:white; font-size:2.5rem; font-weight:700; text-shadow:2px 2px 4px rgba(0,0,0,0.3); margin:0; letter-spacing:1px; }
    .nav { background:linear-gradient(135deg,#90caf9 0%,#a5d6a7 100%); padding:20px 40px; display:flex; justify-content:flex-start; gap:15px;}
    .nav a { text-decoration:none; color:black; font-weight:600; padding:12px 20px; border-radius:25px; background:rgba(255,255,255,0.2); backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,0.3); transition:all 0.3s ease; font-size:14px;}
    .nav a:hover { background:rgba(255,255,255,0.3); transform:translateY(-2px); box-shadow:0 5px 15px rgba(0,0,0,0.2);}
    .content { padding:40px; }
    .ride-block { margin-bottom:30px; background:linear-gradient(135deg,#e1f5fe 0%,#f3e5f5 100%); border-radius:15px; padding:25px; box-shadow:0 8px 25px rgba(0,0,0,0.1); color:#424242; border:2px solid #e8eaf6; position:relative; overflow:hidden; transition:transform 0.3s ease, box-shadow 0.3s ease;}
    .ride-block:hover { transform:translateY(-5px); box-shadow:0 15px 35px rgba(0,0,0,0.2);}
    .ride-block::before { content:'ğŸš—'; position:absolute; right:20px; top:20px; font-size:30px; opacity:0.3;}
    .ride-title { font-weight:600; color:#1976d2; font-size:1.3rem; margin-bottom:15px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:15px;}
    .ride-info { font-size:1.1rem; margin-bottom:8px;}
    .status-badge { display:inline-block; margin-top:8px; padding:4px 12px; border-radius:12px; font-weight:600; font-size:0.95em; border:1px solid #e0e0e0;}
    .status-confirmed { background:#c8e6c9; color:#388e3c;}
    .status-pending { background:#fff9c4; color:#fbc02d;}
    .status-cancelled { background:#ffcdd2; color:#d32f2f;}
    .cancel-ride-btn { background:linear-gradient(135deg,#ff4757 0%,#ff6b6b 100%); color:white; border:none; padding:10px 18px; border-radius:20px; cursor:pointer; font-weight:600; font-size:12px; transition:all 0.3s ease; box-shadow:0 3px 10px rgba(255,71,87,0.3); text-transform:uppercase; letter-spacing:0.5px;}
    .cancel-ride-btn:hover { transform:translateY(-2px); box-shadow:0 5px 15px rgba(255,71,87,0.5);}
    ul { list-style:none; padding:0; margin-top:20px;}
    li { background:rgba(255,255,255,0.8); margin:10px 0; padding:15px 20px; border-radius:10px; font-size:0.95rem; line-height:1.4; border-left:4px solid #66bb6a; border:1px solid #e0e0e0;}
    li b { color:#1976d2; }
    .no-rides { text-align:center; padding:60px 20px; background:linear-gradient(135deg,#e3f2fd 0%,#f3e5f5 100%); color:#424242; border:2px solid #e8eaf6; border-radius:15px; font-size:1.2rem; position:relative;}
    .no-rides::before { content:'ğŸš—ğŸ’¤'; display:block; font-size:60px; margin-bottom:20px; opacity:0.7;}
    @media (max-width:768px) { .container{margin:10px;border-radius:15px;} .header,.nav,.content{padding:20px;} h1{font-size:2rem;} .nav{flex-direction:column;text-align:center;} .ride-title{flex-direction:column;text-align:center;} }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ‘¨â€âœˆï¸ Driver Dashboard</h1>
    </div>
    <div class="nav">
      <a href="/">âŒ‚ Home</a>
      <a href="/add">â• Add Ride</a>
      <a href="/logout">ğŸšª Logout</a>
    </div>
    <div class="content">
      <% if (rideBookings.length === 0) { %>
        <div class="no-rides">
          You haven't created any rides yet!<br>
          <small>Click "Add Ride" to start offering rides to passengers.</small>
        </div>
      <% } else { %>
        <% rideBookings.forEach(function(rb) { %>
          <div class="ride-block">
            <div class="ride-title">
              <div>
                <div class="ride-info"><b><%= rb.ride.from %></b> â¡ï¸ <b><%= rb.ride.to %></b></div>
                <div class="ride-info">ğŸ• <%= rb.ride.time %> | ğŸ’° â‚¹<%= rb.ride.price %> | ğŸ’º <%= rb.ride.seats %> seats</div>
              </div>
              <form action="/cancel-ride/<%= rb.ride._id %>" method="POST">
                <button type="submit" class="cancel-ride-btn">âŒ Cancel Ride</button>
              </form>
            </div>
            <div style="border-top:1px solid rgba(0,0,0,0.1); padding-top:20px; margin-top:20px;">
              <h3 style="color:#1976d2; margin-bottom:15px; font-size:1.1rem;">ğŸ“‹ Bookings:</h3>
              <ul>
                <% if (rb.bookings.length === 0) { %>
                  <li style="text-align:center; font-style:italic; opacity:0.8;">ğŸ” No bookings for this ride yet. Share your ride!</li>
                <% } %>
                <% rb.bookings.forEach(function(b) { %>
                  <li>
                    ğŸ‘¤ Booked by: <b><%= b.rider ? b.rider.username : 'Unknown' %></b><br>
                    ğŸ“… Booking Date: <%= new Date(b.bookedAt).toLocaleString() %><br>
                    <span class="status-badge <%= b.status==='confirmed'?'status-confirmed':b.status==='pending'?'status-pending':'status-cancelled' %>">
                      <%= b.status.charAt(0).toUpperCase() + b.status.slice(1) %>
                    </span>
                    <% if (b.status === 'pending') { %>
                      <form action="/booking/<%= b._id %>/confirm" method="POST" style="display:inline;">
                        <button type="submit" class="cancel-ride-btn" style="background:#66bb6a; margin-left:8px;">CONFIRM</button>
                      </form>
                    <% } %>
                    <% if (b.status === 'pending' || b.status === 'confirmed') { %>
                      <form action="/booking/<%= b._id %>/cancel" method="POST" style="display:inline;">
                        <button type="submit" class="cancel-ride-btn" style="background:#ffb74d; margin-left:8px;">CANCEL</button>
                      </form>
                    <% } %>
                  </li>
                <% }) %>
              </ul>
            </div>
          </div>
        <% }) %>
      <% } %>
    </div>
  </div>
</body>
</html>
